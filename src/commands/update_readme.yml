description: >
  Generate badges from the services of RHEMS BADGES.

parameters:
  update_readme:
    type: string
    default: "true"
    description: "set true or false to update readme"
  file_path:
    type: string
    default: ./README.md
    description: "path of README.md"
  user_name:
    type: string
    default: "badge auto update"
    description: "GitHub user.name"
  user_email:
    type: string
    default: "badges@rhems-japan.co.jp"
    description: "GitHub user.email"

steps:
  - run:
      when: always
      name: update README
      environment:
        GIT_USER_NAME: << parameters.user_name >>
        GIT_USER_EMAIL: << parameters.user_email >>
        FILE_PATH: << parameters.file_path >>
        UPDATE_README: << parameters.update_readme >>
      command: << include(scripts/update_readme.sh) >>
